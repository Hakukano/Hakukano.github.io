<!DOCTYPE html>
<html>
  <body>

    <h1>FLP-GSP Search String Builder</h1>
    <hr/>
    <h2>Result</h2>
    <input id="result" type="text" style="width: 100%;">
    <hr/>

    <h2>Comparison</h2>
    <div>
      <input type="text" id="key" placeholder="Key" style="width: 45%;">
      <span> : </span>
      <input type="text" id="value" placeholder="Value" style="width: 45%;">
      <br/>
    </div>
    <button class="comp_oper" oper="=">Equal</button>
    <button class="comp_oper" oper="~">EqualCI</button>
    <button class="comp_oper" oper=">">Greater</button>
    <button class="comp_oper" oper="<">Lesser</button>
    <button class="comp_oper" oper="*">Wildcard</button>
    <button class="comp_oper" oper="$">Regex</button>

    <hr/>

    <h2>Relation</h2>
    <div id="relation"></div>
    <button class="rel_oper" oper="&">And</button>
    <button class="rel_oper" oper="|">Or</button>
    <button class="rel_oper" oper="!">Not</button>
    <button class="rel_oper" oper="?">Single</button>

    <script>
      $( document ).ready(function() {
        let comparisonCounter = 0

        $('.comp_oper').on('click', function() {
          const key = $('#key').val()
          const oper = $(this).attr('oper')
          const value = $('#value').val()

          const jqFormRelation = $('#relation')

          const checkbox = document.createElement('input')
          checkbox.setAttribute('id', `cb${comparisonCounter}`)
          checkbox.setAttribute('type', 'checkbox')
          jqFormRelation.append(checkbox)

          const input = document.createElement('input')
          input.setAttribute('id', `ip${comparisonCounter}`)
          input.setAttribute('type', 'text')
          input.setAttribute('style', 'width: 95%;')
          input.value = `\`${key}\` ${oper} \`${value}\``
          jqFormRelation.append(input)

          jqFormRelation.append(document.createElement('br'))

          comparisonCounter++
        })

        $('.rel_oper').on('click', function() {
          const selected = []
          $('#relation input:checked').each(function() {
            const id = $(this).attr('id')
            const counter = id.substr(2)
            selected.push($(`#ip${counter}`).val());
          })
          const jqResult = $('#result')
          const result = jqResult.val()
          switch ($(this).attr('oper')) {
            case '&': {
              jqResult.val(`(${result} & ${selected[0]})`)
              break
            }
            case '|': {
              jqResult.val(`(${result} | ${selected[0]})`)
              break
            }
            case '!': {
              jqResult.val(`(! ${result})`)
              break
            }
            case '?': {
              jqResult.val(`${selected[0]}`)
            }
          }
        })
      })
    </script>

  </body>
</html>
